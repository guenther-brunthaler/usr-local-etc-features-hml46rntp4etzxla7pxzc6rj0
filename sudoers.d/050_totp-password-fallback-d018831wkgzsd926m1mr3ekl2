# v2026.38
#
# This is an extension to the functionality provided by
# "/etc/sudoers.d/050_totp-pg8j4t44lthekxg2p4mgtp2px".
#
# A wrapper script
#
# /lib/exec/execute-command
#
# will be accepted by sudo. This is a dummy script just executes whatever
# command will be specified as its argument (or invoke an interactive shell if
# run without any arguments). But if sudo needs a password, it will accept the
# invoking user's password rather than the target account's one.
#
# This means one can do
#
# $ sudo -i
#
# as usual as long as TOTP works. But if TOTP is not possible, then the same
# effect can be achieved by executing
#
# $ sudo /etc/libexec/execute-command
#
# and sudo will ask for the password of the invoking user, nor for the
# password of user 'root'.
#
# Unfortunately, there is a bug lurking here. Do not use this snippet
# until after the bug has been fixed!
#
# The bug is: When running the script via sudo without any arguments, it
# immediately succeeds, never asking for any password whatsoever.

Cmnd_Alias ASK_PSW_OF_INVOKING_USER = /etc/libexec/execute-command

Defaults listpw=never

Defaults!ASK_PSW_OF_INVOKING_USER !targetpw
